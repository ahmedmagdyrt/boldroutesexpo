<!DOCTYPE html>
<html lang='ar' dir='rtl'>
<head>
<meta charset='UTF-8'>
<title>لوحة التحكم</title>
<script src='https://cdn.tailwindcss.com'></script>
<link href='https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap' rel='stylesheet'>
<style>body { font-family: 'Cairo', sans-serif; }</style>
</head>
<body class='bg-gray-100'>
<section id="adminDashboard" class="py-16 bg-white hidden">
        <div class="container mx-auto px-4">
            <div class="max-w-7xl mx-auto bg-white rounded-2xl shadow-xl overflow-hidden">
                <div class="bg-red-600 text-white text-center py-8">
                    <h2 class="text-3xl font-bold">لوحة التحكم - المشرف</h2>
                    <p class="text-xl mt-2">جميع البيانات المسجلة</p>
                </div>
                <div class="p-8">
                    <div class="mb-6">
                        <h3 class="text-2xl font-bold text-gray-800 mb-4">بيانات المسجلين</h3>
                        <p class="text-gray-600 mb-4">إجمالي المسجلين: <span id="totalRegistrations" class="font-bold">0</span></p>
                    </div>
                    
                    <div class="dashboard-table bg-gray-50 rounded-lg p-4 mb-6">
                        <table class="w-full">
                            <thead>
                                <tr class="border-b-2 border-gray-200">
                                    <th class="text-right py-3 px-4 font-bold text-gray-700">الاسم</th>
                                    <th class="text-right py-3 px-4 font-bold text-gray-700">الهاتف</th>
                                    <th class="text-right py-3 px-4 font-bold text-gray-700">الاهتمامات</th>
                                    <th class="text-right py-3 px-4 font-bold text-gray-700">نوع الوحدة</th>
                                    <th class="text-right py-3 px-4 font-bold text-gray-700">الموعد</th>
                                    <th class="text-right py-3 px-4 font-bold text-gray-700">الوقت</th>
                                </tr>
                            </thead>
                            <tbody id="registrationsTable">
                                <!-- Data will be inserted here -->
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="bg-green-50 border-l-4 border-green-400 p-4 mb-6">
                        <div class="flex">
                            <div class="flex-shrink-0">
                                <svg class="h-5 w-5 text-green-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
                                </svg>
                            </div>
                            <div class="mr-3">
                                <p class="text-sm text-green-700">
                                    سيتم إرسال بريد إلكتروني يحتوي على جميع البيانات إلى: <strong>a.magdy.real@gmail.com</strong>
                                </p>
                            </div>
                        </div>
                    </div>
                    
                    <button id="sendEmailBtn" class="bg-blue-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-blue-700 transition-colors">
                        إرسال البيانات عبر البريد الإلكتروني
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-12">
        <div class="container mx-auto px-4">
            <div class="text-center">
                <h3 class="text-2xl font-bold mb-4">معرض بولد روتس</h3>
                <p class="text-gray-300 mb-2">من 22 إلى 25 الشهر الجاري</p>
                <p class="text-gray-300 mb-6">من 10 صباحاً حتى 11 مساءً</p>
                <div class="bg-red-600 inline-block px-6 py-3 rounded-lg">
                    <p class="text-xl font-bold">رقم الاستفسار: 01012502776</p>
                </div>
            </div>
        </div>
    </footer>

    <script>
        // Time slots from 10:00 AM to 11:00 PM (23:00)
        const timeSlots = [
            '10:00 ص', '10:30 ص', '11:00 ص', '11:30 ص', '12:00 م', '12:30 م',
            '1:00 م', '1:30 م', '2:00 م', '2:30 م', '3:00 م', '3:30 م',
            '4:00 م', '4:30 م', '5:00 م', '5:30 م', '6:00 م', '6:30 م',
            '7:00 م', '7:30 م', '8:00 م', '8:30 م', '9:00 م', '9:30 م', '10:00 م', '10:30 م', '11:00 م'
        ];

        // Store registrations
        let registrations = JSON.parse(localStorage.getItem('registrations') || '[]') || [];

        function updateTimeSlots() {
            const selectedDay = document.querySelector('input[name="day"]:checked')?.value;
            const timeSlotsContainer = document.getElementById('timeSlots');
            const selectedTimeInput = document.getElementById('selectedTime');
            
            if (!selectedDay) {
                timeSlotsContainer.innerHTML = '<div class="text-center text-sm text-gray-500 col-span-6">اختر يوماً أولاً لعرض الأوقات المتاحة</div>';
                selectedTimeInput.value = '';
                return;
            }
            
            timeSlotsContainer.innerHTML = '';
            
            timeSlots.forEach(time => {
                const slot = document.createElement('div');
                slot.className = 'time-slot p-2 border border-gray-300 rounded text-center cursor-pointer hover:bg-purple-50';
                slot.textContent = time;
                slot.onclick = function() {
                    // Remove selected class from all slots
                    document.querySelectorAll('.time-slot').forEach(s => {
                        s.classList.remove('selected');
                    });
                    // Add selected class to clicked slot
                    this.classList.add('selected');
                    // Update hidden input
                    document.getElementById('selectedTime').value = `${selectedDay} - ${time}`;
                };
                timeSlotsContainer.appendChild(slot);
            });
        }

        document.getElementById('registrationForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Get form data
            const name = document.getElementById('name').value;
            const phone = document.getElementById('phone').value;
            
            const interests = [];
            document.querySelectorAll('input[name="interest"]:checked').forEach(cb => {
                interests.push(cb.value);
            });
            
            const unitTypes = [];
            document.querySelectorAll('input[name="unitType"]:checked').forEach(cb => {
                unitTypes.push(cb.value);
            });
            
            const day = document.querySelector('input[name="day"]:checked')?.value;
            const selectedTime = document.getElementById('selectedTime').value;
            
            if (interests.length === 0) {
                alert('من فضلك اختر نوع الوحدة التي تهتم بها');
                return;
            }
            
            if (unitTypes.length === 0) {
                alert('من فضلك اختر نوع الوحدة المطلوبة');
                return;
            }
            
            if (!day) {
                alert('من فضلك اختر اليوم المناسب لك');
                return;
            }
            
            if (!selectedTime) {
                alert('من فضلك اختر الوقت المناسب لك');
                return;
            }
            
            // Create data object
            const formData = {
                name,
                phone,
                interests: interests.join(', '),
                unitTypes: unitTypes.join(', '),
                appointment: selectedTime,
                timestamp: new Date().toLocaleString('ar-EG')
            };
            
            // Store registration
            registrations.push(formData);
            localStorage.setItem('registrations', JSON.stringify(registrations));
            
            // Update dashboard
            updateDashboard();
            
            // Show success message
            alert('تم التسجيل بنجاح! سيتم إرسال الانفتيشن إليك خلال 24 ساعة');
            
            // Reset form
            this.reset();
            document.getElementById('timeSlots').innerHTML = '<div class="text-center text-sm text-gray-500 col-span-6">اختر يوماً أولاً لعرض الأوقات المتاحة</div>';
            document.getElementById('selectedTime').value = '';
        });

        function updateDashboard() {
            const dashboard = document.getElementById('adminDashboard');
            const totalRegistrations = document.getElementById('totalRegistrations');
            const registrationsTable = document.getElementById('registrationsTable');
            
            // Show dashboard
            dashboard.classList.remove('hidden');
            
            // Update total count
            totalRegistrations.textContent = registrations.length;
            
            // Clear table
            registrationsTable.innerHTML = '';
            
            // Add registrations to table in reverse order (newest first)
            [...registrations].reverse().forEach(reg => {
                const row = document.createElement('tr');
                row.className = 'border-b border-gray-100';
                
                const [day, time] = reg.appointment.split(' - ');
                
                row.innerHTML = `
                    <td class="py-3 px-4 text-gray-800">${reg.name}</td>
                    <td class="py-3 px-4 text-gray-800">${reg.phone}</td>
                    <td class="py-3 px-4 text-gray-800">${reg.interests}</td>
                    <td class="py-3 px-4 text-gray-800">${reg.unitTypes}</td>
                    <td class="py-3 px-4 text-gray-800">${day}</td>
                    <td class="py-3 px-4 text-gray-800">${time}</td>
                `;
                
                registrationsTable.appendChild(row);
            });
        }

        document.getElementById('sendEmailBtn').addEventListener('click', function() {
            if (registrations.length === 0) {
                alert('لا توجد بيانات مسجلة لإرسالها');
                return;
            }
            
            // In a real application, this would send data to a server
            // For this demo, we'll simulate the email sending process
            
            // Create a summary of registrations
            let emailContent = `مرحباً،\n\nلقد تم تسجيل ${registrations.length} شخص في معرض بولد روتس:\n\n`;
            
            registrations.forEach((reg, index) => {
                emailContent += `${index + 1}. ${reg.name} - ${reg.phone}\n`;
                emailContent += `   الاهتمامات: ${reg.interests}\n`;
                emailContent += `   نوع الوحدة: ${reg.unitTypes}\n`;
                emailContent += `   الموعد: ${reg.appointment}\n\n`;
            });
            
            emailContent += `تم إنشاء هذا التقرير في: ${new Date().toLocaleString('ar-EG')}\n\n`;
            emailContent += `مع تحيات,\nنظام معرض بولد روتس`;
            
            // Simulate email sending
            setTimeout(() => {
                alert(`تم إرسال بريد إلكتروني يحتوي على بيانات ${registrations.length} مسجل إلى a.magdy.real@gmail.com`);
                
                // Create a fake mailto link to demonstrate the concept
                const mailtoLink = `mailto:a.magdy.real@gmail.com?subject=تقرير معرض بولد روتس - ${new Date().toLocaleDateString('ar-EG')}&body=${encodeURIComponent(emailContent)}`;
                
                // In a real app, you would use an API to send the email
                console.log('Email would be sent to:', mailtoLink);
            }, 1000);
        });

        // Initialize dashboard on page load
        window.onload = function() {
            updateDashboard();
            
            // Add a note about how this works in the real world
            console.log("ملاحظة: في التطبيق الحقيقي، سيرسل هذا النظام البيانات إلى خادم وسيتم إرسال البريد الإلكتروني من الخادم. هذا العرض التوضيحي يخزن البيانات في localStorage فقط لأغراض العرض.");
        };
    </script>
</body>
</html>